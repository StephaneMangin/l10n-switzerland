migration:
  options:
    install_args: --load=web,web_kanban,session_redis,attachment_s3,logging_json
  versions:
    - version: 10.0.0
      operations:
        pre:
          # ***********************************************************
          # ************* Avoid auto-install chart of accounts ********
          # ***********************************************************
          - anthem songs.install.master::main
          # Install account without l10n to avoid auto install
          - odoo -i account --stop-after-init --workers=0
          - anthem songs.install.accounting::no_coa_instance_lock
        post:
          - anthem songs.install.accounting::no_coa_instance_unlock
          - anthem songs.install.master::setup_company
          - anthem openerp.addons.cloud_platform.songs::install_exoscale
          - anthem songs.install.base_setup::main
          - anthem songs.install.project::main
          - anthem songs.install.accounting::main
          - anthem songs.install.enfinfidu::main
          # customer_001 (RL Batiment) is the first customer for enfinfidu
          # This songs will be tranformed on customer creation wizard later
          - anthem songs.install.customer_001::main
          - anthem songs.install.data::main
      modes:
        full:
          operations:
            post:
              - anthem songs.install.data_full::main
        demo:
          operations:
            post:
              - anthem songs.install.data_demo::main
      addons:
        upgrade:
          # TECHNICAL MODULES
          - base_technical_features
          - cloud_platform
          - mail_environment
          - server_environment
          # CORE
          - account_accountant
          - account_asset
          - account_budget
          - account_cancel
          - document
          - hr_expense
          - hr_payroll
          - hr_timesheet
          - l10n_ch
          - project
          - sale
          # OCA
          - account_financial_report_qweb
          - account_fiscal_year
          - account_tax_balance
          - hr_public_holidays
          - hr_holidays_compute_days
          - l10n_ch_bank
          - l10n_ch_base_bank
          - l10n_ch_dta
          - l10n_ch_hr_payroll
          - l10n_ch_hr_payroll_report
          - l10n_ch_states
          - l10n_ch_zip
          - mis_builder
          - project_task_default_stage
          - web_sheet_full_width
          - web_hide_db_manager_link
          # LOCAL SOURCE
          - account_move_line_view_menu
          - enfinfidu_account
          - enfinfidu_fct
          - enfinfidu_payroll
          - enfinfidu_project
          - enfinfidu_security
          - hide_powered_by
    - version: 10.4.1
    - version: 10.5.0
    - version: 10.5.1
    - version: 10.6.0
      addons:
        upgrade:
          # Specific Enfinfidu
          - server_environment_files
          - enfinfidu_payroll
          # OCA
          - hr_public_holidays
          - hr_holidays_compute_days
    - version: 10.6.1
      addons:
        upgrade:
          # OCA
          - hr_public_holidays
          - l10n_ch_hr_payroll
    - version: 10.6.2
    - version: 10.6.3
      addons:
        upgrade:
          - enfinfidu_account
          - enfinfidu_fct
          - enfinfidu_report
      operations:
        post:
          - anthem songs.install.davia::main
          - anthem songs.upgrade.10_6_3::main
    - version: 10.6.4
      addons:
        upgrade:
          - enfinfidu_payroll
    - version: 10.6.5
      operations:
        post:
          - anthem songs.upgrade.10_6_5::main
      addons:
        upgrade:
          - enfinfidu_report
    - version: 10.6.6
      operations:
        pre:
          - psql -f /opt/odoo/songs/upgrade/10_6_6.sql
      addons:
        upgrade:
          # OCA/l10n-switzerland
          - l10n_ch_base_bank  # Because repository have been updated
          - l10n_ch_hr_payroll

    - version: 10.7.0
      operations:
        post:
          - anthem songs.install.reliure_des_planches::main
          - anthem songs.install.reliure_des_planches_sarl::main
    - version: 10.7.1
      operations:
        post:
          - anthem songs.upgrade.10_7_1::main
      addons:
        upgrade:
          - enfinfidu_report
    - version: 10.8.0
      addons:
        upgrade:
          - crm
          - survey
          - account_credit_control
          - account_payment_order
          - enfinfidu_security
          - enfinfidu_report
      operations:
        post:
          - anthem songs.upgrade.10_8_0::main
    - version: 10.9.0
      modes:
        full:
          operations:
            post:
              - anthem songs.upgrade.10_9_0::main
      addons:
        upgrade:
          - account_fiscal_year
          - account_credit_control
    - version: 10.10.0
      addons:
        upgrade:
          # OCA/server-tools
          - server_environment_ir_config_parameter
          # OCA/web
          - web_environment_ribbon
